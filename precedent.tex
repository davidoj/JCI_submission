%!TEX root = main.tex

\section[Precedented options]{When options are precedented}\label{sec:precedent}

We have suggested that conditionally independent and identical responses is usually an unreasonably strong assumption for a decision maker to make, on the grounds that it implies overly strong interchangeability properties between different datasets. One way to get around this objection is to suppose that conditionally independent and identical responses are shared by pairs $(\RV{E}_i,\RV{X}_{i})$ where the $\RV{E}_i$ are in fact latent variables. In this case, the assumption would still assert that infinite $(\RV{E}_i,\RV{X}_{i})$ sequences arising from observation would be interchangeable with infinite $(\RV{E}_j,\RV{X}_{j})$ sequences arising as consequences of actions, but because the $\RV{E}_i$ are never observed these interchanges do not imply that we would use the same model for different experiments.

To simplify the presentation, we will consider a specific kind of decision model featuring long sequence of exchangeable observations indexed by natural numbers that are unresponsive to the decision maker's choice and ``one more'' variable representing the ``consequences of action'' indexed by the special character $c$ that may be responsible ot the decision maker's choice. That is, we have $(\RV{X}_i)_{i\in \mathbb{N}}$ unresponsive to the decision maker and $(\RV{X}_c)$ responsive to the decision maker. Call this setup a ``see-do model''.

\begin{definition}[See-do model]
A see-do model is an decision model $(\prob{P}_\cdot,\Omega,C)$ along with a sequence of variables $\RV{X}_{\mathbb{N}\cup\{c\}}$ where $\RV{X}_{\mathbb{N}}\CI^e_{\prob{P}_\cdot} \mathrm{id}_C$. We specify a see-do model with the shorthand $(\prob{P}_\cdot,\RV{X}_{\mathbb{N}\cup\{c\}})$.
\end{definition}

If we want to take a see-do model $(\prob{P}_\cdot,\RV{X}_{\mathbb{N}\cup\{c\}})$ and refine the sample space with a latent sequence $E_{\mathbb{N}\cup\{c\}}$ such that $(\prob{P}_\cdot',\RV{E}_{\mathbb{N}\cup\{c\}},\RV{X}_{\mathbb{N}\cup\{c\}})$ has conditionally independent and identical responses (Definition \ref{def:cii_rf}), then the set of conditionals $\prob{P}_C^{\RV{X}_i|\RV{E}_i\RV{H}}$ must be sufficiently diverse to produce the observed distribution over $\RV{X}_{\mathbb{N}\cup\{c\}}$ for every option $\alpha\in C$, see Example \ref{ex:construction_latent_set}.

\begin{example}\label{ex:construction_latent_set}
Suppose we have a see-do model $(\prob{P}_\cdot, \RV{X}_{\mathbb{N}\cup\{c\}})$ where each $\RV{X}_i$ takes values in a binary set, and the control we can exert is to choose either $\prob{P}_{0}^{\RV{X}_c} = \frac{1}{4}\delta_0 + \frac{3}{4}\delta_1$ or $\prob{P}_{1}^{\RV{X}-c} = \frac{1}{2}\delta_0 + \frac{1}{2}\delta_1$, independent of all other observations. Suppose further that for $i\in \mathbb{N}$, $\prob{P}_C^{\RV{X}_i}=\frac{3}{4}\delta_0 + \frac{1}{4}\delta_1$ independent of all other observations. Then we can consider this model to be IO contractible with latent binary inputs $\RV{E}_i$ such that
\begin{align}
	\prob{P}_\alpha^{\RV{X}_i|\RV{E}_i}(\cdot|e) &= \delta_e
\end{align}

This is not the only way to construct such a model. We could instead choose latent binary inputs $\RV{E}_i'$ such that
\begin{align}
	\prob{P}_\alpha^{\RV{X}_i|\RV{E}_i'}(\cdot|e) &= \begin{cases}
		\frac{3}{4}\delta_0 + \frac{1}{4}\delta_1 & e=0 \\
		\frac{1}{4}\delta_0 + \frac{3}{4}\delta_1 & e=1
	\end{cases}
\end{align}

On the other hand, the choice $\RV{E}_i^{\prime\prime}$ with
\begin{align}
	\prob{P}_\alpha^{\RV{X}_i|\RV{E}_i''}(\cdot|e) &= \begin{cases}
		\frac{1}{2}\delta_0 + \frac{1}{2}\delta_1 & e=0 \\
		\frac{1}{4}\delta_0 + \frac{3}{4}\delta_1 & e=1
	\end{cases}
\end{align}
cannot be latent binary inputs for a conditionally independent and identical response model, as the observational distribution cannot be written as any convex combination of $\prob{P}_\alpha^{\RV{X}_i|\RV{E}_i''}(\cdot|0)$ and $\prob{P}_\alpha^{\RV{X}_i|\RV{E}_i''}(\cdot|1)$.
\end{example}

Note that in the first construction in example \ref{ex:construction_latent_set}, but not the following two, we have $\prob{P}_C^{\RV{E}_i} \gg \prob{P}_\alpha^{\RV{E}_c}$ for all $\alpha$. We say under this construction the options have \emph{precedent}; they have, in a sense, ``been done before''. Note that this is a consequence of how we chose to parametrise the latent conditionals. One of the open questions of this work is understanding when we can reasonably make choices like this while maintaining the other properties required for Theorem \ref{th:latent_to_observable}.

Theorem \ref{th:latent_to_observable} shows that a slightly strengthened version of this assumption of precedent can have signigicant implications for a decision maker who wants to infer consequences from their observations. This theorem is motivated by the following example:

\begin{example}\label{ex:doctor_precedent}
Suppose a decision maker collects data about a group of peope who have variously engaged the services of dietiticians, sporting coaches, general practitioners, bariatric surgeons and none of the above, with practitioner choice recorded under the variable $\RV{Z}_i$. The decision maker has also collected data on each person's body mass index $\RV{X}_i$ at the beginning of the study and followed mortality outcomes $\RV{Y}_i$ for a considerable period of time. A decision maker is reviewing this data, and in particular is wondering if steps they take to manage their weight $\RV{X}_c$ are likely to improve their own mortality prospects $\RV{Y}_c$.

Our decision maker presumes that each group of people $\RV{Z}_i$ has, in aggregate, different strategies for pursuing weight management and different contextual reasons for doing so (though, for the sake of this example, we suppose that the decision maker doesn't collect data on any of these facts). Because of this variation, the decison maker reasons, people in these different groups with different levels of body mass index should see different mortality results \emph{if, conditional on body mass index, the different circumstances and management strategies actually lead to different results}. Conversely, if there is \emph{no} variation in results for these different groups of people, then it would appear that, at least with regard to mortality, the eventual body mass index achieved is apparently the \emph{only} important feature of any management plan.

This inference might fail if, for any reason, the variation in treatment plans and contexts between the different groups of people surveyed masks the variation in their effects. For example, if all groups of people overwhelmingly choose to pursue diet changes in the end and other dimensions of variation are simply not very important to the outcome, then their results will not reveal any variation in mortality outcomes due to different treatment strategies. Alternatively, it might be the case that everybody is making choices that achieve nearly optimal mortality prospects given their unobserved context and that the best achievable mortality outcomes are approximately the same for each person's achievable level of body mass index. In this case there may still be substantial variation in outcomes from different weight management strategies, but it is masked by the fact that everyone is making near-optimal choices.

If the decision maker finds that $\RV{Y}_i$ is not independent of $\RV{Z}_i$ given $\RV{X}_i$, they may also consider whether $\RV{Y}_i$ is independent of $\RV{Z}_i$ given $(\RV{V}_i,\RV{X}_i)$ for some set of covariates $\RV{V}_i$.
\end{example}

Theorem \ref{th:latent_to_observable} establishes formal conditions for the informal deduction described in Example \ref{ex:doctor_precedent}. We assume that all variables of interest are discrete, and make use of an alternative notation for discrete conditional probabilities.

\begin{definition}[Index notation for discrete conditionals]
Given a joint probability distribution $\mu^{\RV{XY}}$ with $\RV{X}$ and $\RV{Y}$ discrete, let $\mu^y_x:=\mu^{\RV{Y}|\RV{X}}(\{y\}|x)$ and $\mu^Y_X:= (x,y)\mapsto \mu^y_x$
\end{definition}

The key assumption for Theorem \ref{th:latent_to_observable} is an assumption we call \emph{diverse precedent}. It's a rather complicated assumption. It imposes a domination condition that requires (roughly speaking) that the distribution of the latent input $\RV{E}_i$ given event $\RV{Z}_i=z$ almost surely dominates the distribution induced by any option we can choose (as in the discussion of precedent above) \emph{and} is almost surely ``diverse'' for different values of $\RV{Z}_i$.

\begin{definition}[Diverse precedent]
Given a see-do model $(\prob{P}_\cdot,(\RV{E}_i,\RV{X}_i,\RV{Y}_i,\RV{Z}_i)_{i\in\mathbb{N}\cup\{c\}})$ with $E,X,Y$ and $Z$ all discrete sets, suppose among the observations $i\in \mathbb{N}$ the pairs $(\RV{Z}_i,(\RV{E}_i,\RV{X}_i,\RV{Y}_i))$ share conditionally independent and identical responses and, for all observations and consequences $i\in \mathbb{N}\cup\{c\}$, pairs $(\RV{E}_i,(\RV{X}_i,\RV{Y}_i))$ also share conditionally independent and identical responses.

Take $\RV{G}$ to be the directing random conditional of $(\prob{P}_\cdot,\RV{Z}_{\mathbb{N}},(\RV{E}_i,\RV{X}_i,\RV{Y}_i)_{i\in \mathbb{N}})$. 

We say that the options $C$ have \emph{diverse precedent} with respect to $(\prob{P}_\cdot,(\RV{E}_i,\RV{X}_i,\RV{Y}_i,\RV{Z}_i)_{i\in\mathbb{N}\cup\{c\}})$ if for all $\alpha$, $\prob{P}_\alpha$-almost all $z,z'\in Z$, $e\in E$, $g^E_{z}\in \Delta(E)$, $g^{XY}_{EZ}\in \Delta(X\times Y)^{E\times Z}$, $\prob{P}_\alpha$ satisfies the condition:
\begin{align}
	\prob{P}_{\alpha}^{\RV{G}^E_{z'}|\RV{G}^{XY}_{EZ}\RV{G}^E_{z}}(\cdot|g^{XY}_{EZ},g^E_{z}) \ll U_{\Delta(E)}\label{eq:lebesgue_dom}
\end{align}
Where $U_{\Delta(E)}$ is the uniform measure on the $|E-1|$ simplex of discrete probability distributions with $|E|$ outcomes.
\end{definition}

For Theorem \ref{th:latent_to_observable}, we assume that on the basis of observations we condition the probability on some event $I$ (in particular, we are interested in the case where $I$ is the event that a certain conditional independence holds).

\begin{theorem}[Latent to observable IO contractibility]\label{th:latent_to_observable}
Given a see-do model $(\prob{P}_\cdot,(\RV{E}_i,\RV{X}_i,\RV{Y}_i,\RV{Z}_i)_{i\in\mathbb{N}\cup\{c\}})$ with $E,X,Y$ and $Z$ all discrete sets, suppose among the observations $i\in \mathbb{N}$ the pairs $(\RV{E}_i,(\RV{X}_i,\RV{Y}_i,\RV{Z}_i))$ share conditionally independent and identical responses and, for all observations and consequences $i\in \mathbb{N}\cup\{c\}$, pairs $(\RV{E}_i,(\RV{X}_i,\RV{Y}_i))$ also share conditionally independent and identical responses. Take $\RV{G}$ to be the directing random conditional of $(\prob{P}_\cdot,\RV{Z}_{\mathbb{N}},(\RV{E}_i,\RV{X}_i,\RV{Y}_i)_{i\in \mathbb{N}})$.

Let $I\subset \Delta(Y)^{XZ}$ be the event $\RV{G}^Y_{Xz}=\RV{G}^Y_{Xz'}$ for all $z,z'\in Z$; i.e. the event that $\RV{Y}_i$ is independent of $\RV{Z}_i$ conditional on $\RV{X}_i$ and $\RV{G}$. Define $\prob{Q}_\alpha\in \Delta(\Omega)$ to be the probability measure such that, for all $A\in \sigalg{F}$
\begin{align}
\prob{Q}_\alpha(A) := \prob{P}_\alpha^{\mathrm{id}_\Omega|\mathds{1}_I\circ \RV{G}}(A|1)
\end{align}
i.e. $\prob{Q}_\alpha$ is $\prob{P}_\alpha$ conditioned on $\RV{G}^Y_{XZ}\in I$, so $\RV{Y}_i\CI^e_{\prob{Q}_\cdot} \RV{Z}_i|(\RV{X}_i,\mathrm{id}_C)$.

If the options $C$ have diverse precedent with respect to $(\prob{Q}_\cdot,(\RV{E}_i,\RV{X}_i,\RV{Y}_i,\RV{Z}_i)_{i\in\mathbb{N}\cup\{c\}})$, then $(\prob{Q}_\cdot,\RV{X},\RV{Y})$ is also IO contractible.
\end{theorem}

\begin{proof}
We show that the assumption of conditional independence imposes a polynomial constraint on $\RV{G}^d_z$ which is nontrivial unless $\RV{Y}_i\CI^e (\RV{Z}_i,\RV{E}_i,\text{id}_C)|(\RV{X}_i,\RV{H})$, and hence the solution set $S$ for this constraint has measure 0 when this conditional independence does not hold.

Full proof in Appendix \ref{sec:proof_precedent}.
\end{proof}

\subsection{Under what circumstances is the assumption of diverse precedent appropriate?}

The assumption of diverse precedent is critical to Theorem \ref{th:latent_to_observable}. To see why this is critical, consider that every sequence $(\RV{X}_i,\RV{Y}_i)_{i\in\mathbb{N}}$ can be transformed to the IO contractible sequence $((\RV{X}_i,\RV{Y}_i),(\RV{X}_i,\RV{Y}_i))_{i\in\mathbb{N}}$. Thus, without the diverse precedent assumption, \emph{any} nontrivial conditional independence would imply observable IO contractibility. However, the sequence $((\RV{X}_i,\RV{Y}_i),(\RV{X}_i,\RV{Y}_i))_{i\in\mathbb{N}}$ does not satisfy the diverse precedent assumption. In particular, if $\RV{Y}_i \CI^e_{\prob{Q}} \RV{Z}_i | (\RV{X}_i,\RV{G}^Y_{XZ}, \mathrm{id}_C)$ then fixing $\RV{G}^{XY}_{z}=g^{XY}_z$ for some $z$ implies $\RV{G}^{XY}_{z'}$ must be such that $\RV{G}^Y_{Xz} = \RV{G}^Y_{Xz'}$, a Lebesgue measure 0 event.

If $\prob{P}_\alpha^{\RV{G}}$ is dominated by the uniform measure on $\Delta(EXYZ)$, then $\prob{P}_\alpha^{\RV{G}^E_Z|\RV{G}^{XY}_{EZ}}(\cdot|g^{XY}_{EZ})$ is dominated by the uniform measure on $\Delta(E)^Z$ for almost all $(g^{XY}_{EZ},g^Z)$ \citep[pg. 155]{cinlar_probability_2011}. However, this is not enough for Theorem \ref{th:latent_to_observable} -- we condition on $I\subset \Delta(Y)^{XZ}$, which is a measure 0 event with respect to the uniform measure on $\Delta(EXYZ)$.

In light of this, it would be very useful to extend Theorem \ref{th:latent_to_observable} to an approximate result. Specifically, in the event $\RV{Y}_i$ is approximately independent of $\RV{Z}_i$ given $\RV{X}_i$ and $\RV{G}$, under what conditions is $\RV{Y}_i$ also approximately independent of $\RV{E}_i$ given $\RV{X}_i$ and $\RV{G}$? 

For theorem \ref{th:latent_to_observable} to hold, the latent inputs must support the assumption of diverse precedent for the conditional $\RV{G}^E_Z$, and for an approximate result along the same lines we posit that a stronger requirement of diversity for the posterior over conditional distributions $\{\RV{G}^E_z|z\in Z\}$ will be necessary. We don't know in general how these requirements should be understood.

The diverse precedent assumption also has a connection to the theory of causal graphical models. \citet{meek_strong_1995} justified the \emph{faithfulness} condition for causal graphs associated with discrete probability models on the assumption that the distribution of parameters of a distribution consistent with a particular causal graph are dominated by the Lebesgue measure. In this theory, we have a discrete set of hypotheses over causal structures that imply some conditional independences, and Lebesge-dominated priors over the directing measure after conditioning on any of the causal structure hypotheses and their associated independences. Applying similar reasoning to the present case, we posit an argument along these lines: if we have the independence $\RV{Y}_i\CI^e_{\prob{Q}}(\RV{E}_i,\RV{Z}_i)|(\RV{X}_i,\RV{G},\mathrm{id}_C)$ but not the independence $\RV{E}_i\CI^e_{\prob{Q}} \RV{Z}_i|(\RV{G},\mathrm{id}_C)$ and furthermore $\RV{Z}_i$ is an ancestor of $\RV{E}_i$ and $(\RV{E}_i,\RV{Z}_i)$ is an ancestor of $(\RV{X}_i,\RV{Y}_i)$ (so that $\RV{G}^E_Z$ and $\RV{G}^{XY}_{EZ}$ are associated with forward edges in the causal model) then the diverse precedent assumption may be supported. Note that it may be possible to rule out the independence $\RV{E}_i\CI^e_{\prob{Q}} \RV{Z}_i|(\RV{G},\mathrm{id}_C)$ on the basis of the non-independence of $\RV{Z}_i$ and $\RV{X}_i$.

Another relation between theory of causal graphical models and the present work may be found in the \emph{causal version of the principle of maximum entropy} \citep{sunCausalInferenceChoosing2006,janzingCausalVersionsMaximum2021}. The causal version of the principle of maximum entropy, in contrast to the standard version of the principle, suggests that priors be specified by sequentially maximising the entropy of a cause, then maximising the conditional entropy of the first effect given the cause and so forth. While the cited articles discuss using the principle of entropy maximisation to specify prior distributions over observed variables rather than distributions over directing conditionals, the same principle may perhaps be applied to the specification of priors over directing conditionals. We posit that the causal version of the prinicple of maximum entropy might support a similar line of argument: if $\RV{Y}_i\CI^e_{\prob{Q}}(\RV{E}_i,\RV{Z}_i)|(\RV{X}_i,\RV{G},\mathrm{id}_C)$ but not independence $\RV{E}_i\CI^e_{\prob{Q}} \RV{Z}_i|(\RV{G},\mathrm{id}_C)$ and $\RV{Z}_i$ is an ancestor of $\RV{E}_i$ and $(\RV{E}_i,\RV{Z}_i)$ is an ancestor of $(\RV{X}_i,\RV{Y}_i)$, then perhaps the causal version of the principle of maximum entropy offers some support for the diverse precedent assumption. Note that this (as well as the implication suggested in the previous paragraph) are highly speculative.

\section{Conclusion}

We employ a decision theoretic approach to causal inference to investigate two different approaches to answering the question ``how do my observations relate to the consequences of my choices?'' Our approach allows us to consider the question of what observations and consequences have in common independently from any prior knowledge the decision maker might have about how their choices influence outcomes -- neither Theorem \ref{th:ciid_rep_kernel} nor Theorem \ref{th:latent_to_observable} depend on any assumptions about a decision maker's prior knowledge of the effects of their different options (though the plausibility of the assumptions in both theorems may well depend on such prior knowledge).

The grand aim of this work is to facilitate causal inference in situations where a decision maker has relatively little causal knowledge at the outset. We think avoiding structured interventions in this setting is advantageous because we regard the question of whether an action is known in advance to influence a particular variable as substantially more transparent than the question of whether it is well modeled by a structured intervention (of any type) on that variable.

Nevertheless, this work leaves many open questions for causal inference in the low prior knowledge setting. We have argued that the assumptions required for Theorem \ref{th:ciid_rep_kernel} are unlikely to be compelling in many situations. While Theorem \ref{th:latent_to_observable} may be more broadly plausible, we've identified the ``dominated posterior'' assumption as a particularly difficult one to evaluate. We've suggested that there might be a connection between this assumption and causal structure assumptions. If this is so, one might also want to ask how often the relevant structural assumptions are transparent to a decision maker.

For any practical inference, a generalisation of Theorem \ref{th:latent_to_observable} to approximate independence is in order. Such a generalisation may bring additional clarity to the diverse precedent assumption.

Despite these challenges, we are encouraged by a number of features of this work. Using decision making as a starting point for constructing models means that, at the outset, we are only making commitments a decision maker is likely to already be making if they want to apply a formal theory of decision making. The informal idea of precedent that underpins Theorem \ref{th:latent_to_observable} seems like a general principle that may be applicable in a broad range of data-driven decision making problems. Finally, the apparent connection between Theorem \ref{th:latent_to_observable} suggests that much of the work already done in the world of causal graphical models may be applicable to our alternative perspective. Causal inference under circumstances of limited prior knowledge presents many hard conceptual as well as practical problems, and our approach is a promising new avenue of investigation.